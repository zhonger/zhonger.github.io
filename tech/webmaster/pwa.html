<!DOCTYPE html>

<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PWAï¼šå¯èƒ½æ˜¯æˆæœ¬æœ€ä½çš„ç«™ç‚¹åŠ é€Ÿæ–¹å¼ - Mr Li</title>
    <meta name="author"  content="zhonger">
    <meta name="description" content="PWAï¼šå¯èƒ½æ˜¯æˆæœ¬æœ€ä½çš„ç«™ç‚¹åŠ é€Ÿæ–¹å¼">
    <meta name="keywords"  content="PWA, æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº, å°ç¨‹åº, åŠ é€Ÿ, Accelerate">
    <!-- Open Graph -->
    <meta property="og:title" content="PWAï¼šå¯èƒ½æ˜¯æˆæœ¬æœ€ä½çš„ç«™ç‚¹åŠ é€Ÿæ–¹å¼ - Mr Li">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lisz.me/tech/webmaster/pwa.html">
    <meta property="og:baseurl" content="">
    <meta property="og:description" content="ä¸ªäººçš„ä¸€ä¸ªæŠ€æœ¯åšå®¢ç«™ç‚¹ï¼Œä¸»è¦ç”¨äºè®°å½•ä¸ªäººåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°çš„æŠ€æœ¯é—®é¢˜åŠè§£å†³æ–¹æ³•ã€æŠ€æœ¯å®éªŒï¼Œä»¥åŠä¸€äº›æ¯”è¾ƒæœ‰è¶£çš„äº‹æƒ…ã€‚">
    <meta property="og:site_name" content="Mr Li">
    <meta property="og:gray" content="false">
    <meta property="post-date-format" content="0">
    
    <meta property="post-date" content="2022-06-03 10:54:00 +0900" />
    
    
    <meta name="google-site-verification" content="v729JR7Zs4nX-YvgaPeo3p1ise9vTA-6cMhamSu6N5c" />
    
    <meta name="theme-color" content="#81BBFF" />
    <link rel="manifest" href="/manifest.json" />
    <link rel="apple-touch-icon" href="/assets/img/touch/apple-touch-icon.png"/>
    <link rel="Shortcut Icon" href="/assets/icons/favicon.ico">
    <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" />
    <link rel="bookmark" href="/assets/icons/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/normalize.min.css" />
    <link rel="stylesheet" href="/assets/css/plugins.min.css" />
    <link rel="preload" href="/assets/fonts/Merriweather-Regular.ttf" as="font" crossorigin="anonymous" />
    <link rel="stylesheet" href="/assets/fonts/Merriweather-Regular.ttf" media="print" onload="this.media='all'" />
    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-themes@1.9.0/themes/prism-one-light.min.css" />
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/plugins/line-numbers/prism-line-numbers.min.css">
    
    <link rel="stylesheet" href="/assets/css/app.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.css" />
    <script src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
</head>



<body class="line-numbers" ontouchstart="">


  <!--[if lt IE 10]>
  <div class="alert-danger" role="alert">ä½ çš„æµè§ˆå™¨å®åœ¨å¤ªå¤ªå¤ªæ—§äº†ï¼Œæ”¾å­¦åˆ«èµ°ï¼Œå‡çº§å®Œæµè§ˆå™¨å†è¯´ï¼<a target="_blank" class="alert-link" href="http://browsehappy.com">ç«‹å³å‡çº§</a></div>
  <![endif]-->
  
  <div id="all" class="post">
  
    <input id="nm-switch" type="hidden" value="false"> <header class="g-header">
    <div class="g-logo">
      <a href="/" aria-label="logo"></a>
    </div>
    <!-- <i id="menu-toggle" class="iconfont icon-menu"></i> -->
    <div id="mode-toggle">
        <svg class="icon icon-day" aria-hidden="true">
            <use xlink:href="#icon-day"></use>
        </svg>
        <svg class="icon icon-night" aria-hidden="true">
            <use xlink:href="#icon-night"></use>
        </svg>
    </div>
    <svg id="menu-toggle" class="icon-menu" aria-hidden="true">
        <use xlink:href="#icon-menu"></use>
    </svg>
    <nav class="g-nav">
        <ul>
            
            <li>
                <a href="/" aria-label="home">
                    home
                </a>
            </li>
            
            <li>
                <a href="/blog/index.html" aria-label="blog">
                    blog
                </a>
            </li>
            
            <li>
                <a href="/archives.html" aria-label="archives">
                    archives
                </a>
            </li>
            
            <li>
                <a href="/tags.html" aria-label="tags">
                    tags
                </a>
            </li>
            
            <li>
                <a href="/feed.xml" aria-label="RSS">
                    RSS
                </a>
            </li>
            
            <li>
                <a href="/logs.html" aria-label="logs">
                    logs
                </a>
            </li>
            
            <li class="mode">
                <svg class="icon day" aria-hidden="true">
                    <use xlink:href="#icon-day"></use>
                </svg>
                <svg class="icon night" aria-hidden="true">
                    <use xlink:href="#icon-night"></use>
                </svg>
            </li>
        </ul>
    </nav>
</header>


    <header
      class="g-banner post-header post-pattern-food bgcolor-default "
      data-theme="default"
    >
      <div class="post-wrapper">
        <div class="post-tags">
          
            
              <a href="/tags.html#PWA" class="post-tag">PWA</a>
            
              <a href="/tags.html#%E6%B8%90%E8%BF%9B%E5%BC%8F%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F" class="post-tag">æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº</a>
            
              <a href="/tags.html#%E5%B0%8F%E7%A8%8B%E5%BA%8F" class="post-tag">å°ç¨‹åº</a>
            
              <a href="/tags.html#%E5%8A%A0%E9%80%9F" class="post-tag">åŠ é€Ÿ</a>
            
              <a href="/tags.html#Accelerate" class="post-tag">Accelerate</a>
            
          
        </div>
        <h1>PWAï¼šå¯èƒ½æ˜¯æˆæœ¬æœ€ä½çš„ç«™ç‚¹åŠ é€Ÿæ–¹å¼</h1>
        <div class="post-meta">
          <span class="post-meta-item">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-user"></use>
            </svg>
            zhonger
          </span>
          <time class="post-meta-item" datetime="22-06-03">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-calendar"></use>
            </svg>
            <span class="create-at"></span>
          </time>
          <time class="post-meta-item" datetime="22-06-03">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-update"></use>
            </svg>
            <span class="update-at"></span>
          </time>
          
            <span class="post-meta-item">
              <svg class="icon words" aria-hidden="true">
                <use xlink:href="#icon-words"></use>
              </svg>
              
              æœ¬æ–‡æ€»å…±  7.0k  å­—
            </span>
            <span class="post-meta-item">
              <svg class="icon time" aria-hidden="true">
                <use xlink:href="#icon-time"></use>
              </svg>
              é˜…è¯»å…¨æ–‡å¤§çº¦éœ€è¦ 21 åˆ†é’Ÿ
            </span>
            
              <span class="post-meta-item">
                <svg class="icon pv" aria-hidden="true">
                  <use xlink:href="#icon-pv"></use>
                </svg>
                æœ¬æ–‡æ€»é˜…è¯»é‡ <span id="busuanzi_value_page_pv"></span> æ¬¡ 
              </span>
            
          
          
            <span class="post-meta-item">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-image"></use>
              </svg>
              
                
                  å°é¢å›¾ç‰‡ç”± <a href="https://unsplash.com/@marcojodoin" target="_blank">Marc-Olivier Jodoin</a> æä¾›
                
              
            </span>
          
        </div>
      </div>
      
      <div class="filter"></div>
        <div class="post-cover" style="background: url('https://i.luish.cc/cover/EBXSnv.webp') center no-repeat; background-size: cover;"></div>
      
    </header>
    <div class="post-content visible">
      
      <h2 class="post-subtitle">ä½ çŸ¥é“ç°åœ¨æµè¡Œçš„å¾®ä¿¡å°ç¨‹åºå®é™…ä¸Šä¹Ÿæ˜¯ PWA çš„ä¸€ç§å—ï¼Ÿ</h2>
      

      
      <div class="container">  
        <div class="contents">
          <article class="markdown-body">
            <h2 id="å‰è¨€">å‰è¨€</h2>

<p>â€ƒâ€ƒPWAï¼ˆProgressive Web Appï¼‰ï¼Œä¸­æ–‡ç§°ä¸ºâ€œ<strong>æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº</strong>â€ï¼Œåˆ©ç”¨ä¸€ç³»åˆ—ç°ä»£çš„ Web æŠ€æœ¯æ¥å¢å¼º Web App çš„åŠŸèƒ½ï¼Œä»è€Œå®ç°åº”ç”¨ç¨‹åºä¸€æ ·çš„ç”¨æˆ·ä½“éªŒã€‚äº‹å®ä¸Šï¼Œä»»ä½•çš„ç½‘ç«™éƒ½å¯ä»¥åšæˆ PWAã€‚ä»è¿™ä¸ªæ¦‚å¿µä¸Šæ¥è¯´ï¼ŒPWA å®é™…ä¸Šæ˜¯ä¸€ç§ç†å¿µã€‚æ ¹æ®è¿™ç§ç†å¿µå¯ä»¥åˆ›é€ å‡ºå„å¼å„æ ·çš„ä¸œè¥¿ï¼Œæ¯”å¦‚è¯´å¾®ä¿¡å°ç¨‹åºã€ç™¾åº¦å°ç¨‹åºã€æ”¯ä»˜å®å°ç¨‹åºç­‰ç­‰ï¼ˆğŸ˜‚ è™½ç„¶å®ƒä»¬éƒ½ä¸æ‰¿è®¤è‡ªå·±æ˜¯å’Œ PWA ä¸€è„‰ç›¸æ‰¿çš„ï¼‰ã€‚</p>

<h3 id="ä¸ºä½•æœ‰-pwa">ä¸ºä½•æœ‰ PWA</h3>

<p>â€ƒâ€ƒéšç€ç½‘ç»œå’Œæ™ºèƒ½è®¾å¤‡çš„é£é€Ÿå‘å±•åŠæå‡ï¼Œè¶Šæ¥è¶Šå¤šçš„åŸç”Ÿåº”ç”¨ç¨‹åºå æ®äº†æ™ºèƒ½è®¾å¤‡çš„ç©ºé—´å’Œèµ„æºã€‚æ›¾å‡ ä½•æ—¶ï¼Œä¸€ä¸ªå¾®åšåº”ç”¨ç¨‹åºè¿˜åªæœ‰ 100M å·¦å³ï¼Œç°åœ¨ä¸€å®‰è£…ä¸€ç™»å½•å°±è¦åˆ°å¿« 1Gã€‚å†æ²¡äº‹åˆ·ä¸€åˆ·æ–°é—»æˆ–è€…è§†é¢‘ï¼Œå¯èƒ½å°±è¦å˜æˆ 1.5Gï¼Œç”šè‡³æ›´å¤šã€‚ç±»ä¼¼å¾®åšè¿™æ ·ï¼Œæˆ‘ä»¬æ—¥å¸¸å¯èƒ½å¸¸ç”¨çš„æ·˜å®ã€å¾®ä¿¡ã€QQã€çŸ¥ä¹ç­‰ç­‰å‡ ä¹éƒ½æ˜¯å¦‚æ­¤ã€‚è™½ç„¶è¿™æ ·çš„ç©ºé—´å’Œè¿è¡Œå†…å­˜èµ„æºå ç”¨èƒ½ç»™æˆ‘ä»¬å¸¦æ¥å¾ˆå¥½çš„ç”¨æˆ·ä½“éªŒï¼Œä½†å®é™…ä¸Šè¿˜æ˜¯åœ¨ä¸€ç‚¹ç‚¹æ¦¨å¹²æ™ºèƒ½è®¾å¤‡çš„èµ„æºã€‚æœ€åæ™ºèƒ½è®¾å¤‡è¶Šæ¥è¶Šå¡ï¼Œåªèƒ½ä¾é æ—¶å¸¸æ¸…ç†ã€é‡ç½®æˆ–è€…å‡çº§ç¡¬ä»¶æ¥ç„•å‘æ–°æœºã€‚</p>

<p>â€ƒâ€ƒç›¸æ¯”åŸç”Ÿåº”ç”¨å¼€å‘è€Œè¨€ï¼ŒWeb åº”ç”¨ç¨‹åºçš„å¼€å‘å’Œæ›´æ–°ç»´æŠ¤åˆ™æ˜¾å¾—ä¸è¦å¤ªè½»æ¾ï¼ŒçœŸæ­£å®ç°äº†â€œä¸€éæ›´æ–°æ‰€æœ‰å®¢æˆ·ç«¯é€‚ç”¨â€ã€‚å¦‚æœè¦ä»æ€§èƒ½å’Œå¯è°ƒç”¨è®¾å¤‡èµ„æºæ¥çœ‹ï¼Œå¯èƒ½ä»¥å‰åŸç”Ÿåº”ç”¨è¦å ä¸Šé£ã€‚ä½†æ˜¯éšç€ HTML5 å’Œ CSS3 çš„å‘å±•ï¼ŒWeb åº”ç”¨ç¨‹åºåœ¨æ€§èƒ½å’Œè®¾å¤‡èµ„æºè°ƒç”¨ä¸Šå·²ç»ä¸åŸç”Ÿåº”ç”¨å·®åˆ«æ— äºŒäº†ã€‚æ‰€ä»¥è¶Šæ¥è¶Šå¤šçš„åŸºäº Web æŠ€æœ¯çš„ Hybrid å®¢æˆ·ç«¯æˆ–è€…çº¯ Web å®¢æˆ·ç«¯å¼€å§‹æ¶Œç°ï¼Œæ¯”å¦‚éå¸¸çŸ¥åçš„ç½‘æ˜“äº‘å®¢æˆ·ç«¯ï¼Œæ— è®ºæ˜¯ PC å®¢æˆ·ç«¯è¿˜æ˜¯ç§»åŠ¨å®¢æˆ·ç«¯éƒ½å·²ç»åˆ‡æ¢åˆ°äº† Web æŠ€æœ¯æ ˆã€‚è¿˜æœ‰ç°åœ¨éå¸¸æµè¡Œçš„ä»£ç ç¼–è¾‘å™¨ VS Codeï¼Œæ˜¯åŸºäº Electron æ¡†æ¶è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œå…¶ç®€æ˜“çš„æ“ä½œé€»è¾‘å’Œä¸°å¯Œçš„æ’ä»¶ä¸ºå¼€å‘è€…å¸¦æ¥äº†æ— é™çš„å¯èƒ½ã€‚</p>

<div class="premonition note"> <div class="header"> <svg class="icon note" aria-hidden="true"> <use xlink:href="#icon-note"></use> </svg> <div class="title"> ä»£ç ç¼–è¾‘å™¨å°çŸ¥è¯† </div> </div> <div class="content"> <p>â€ƒâ€ƒä»£ç ç¼–è¾‘å™¨å¯ä»¥ä»æœ¬èº«çš„å¤æ‚ç¨‹åº¦åˆ†æˆä¸¤ç§ï¼šä¸€ç§æ˜¯ä»¥ Eclipseã€Visual Studioã€*Stormï¼ˆPHPStorm ç­‰ï¼‰ã€ Xcodeã€IDEA ä¸ºä»£è¡¨çš„å¤§è€Œå…¨çš„â€œå·¨æ— éœ¸â€ä»£ç ç¼–è¾‘å™¨ï¼Œå¦ä¸€ç§æ˜¯ä»¥ Sublime Textã€Notepad++ã€Atomã€VS Codeã€Brackets ä¸ºä»£è¡¨çš„å°è€Œå®ç”¨çš„â€œç®€æ´â€ä»£ç ç¼–è¾‘å™¨ã€‚<br />
â€ƒâ€ƒâ€œå·¨æ— éœ¸â€ä»£ç ç¼–è¾‘å™¨ä¹Ÿæœ‰å…¶å¥½å¤„ï¼Œèƒ½å¤Ÿæä¾›ä¿å§†å¼çš„ç•Œé¢äº¤äº’ï¼Œå¯èƒ½çœ‹ç€çœå¿ƒä¸€ç‚¹ã€‚ä½†è¿™ä¹Ÿæ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œä½ éœ€è¦å…ˆå­¦ä¹ å¦‚ä½•ä½¿ç”¨ä»£ç ç¼–è¾‘å™¨ï¼Œæ‰èƒ½ç”¨å®ƒæ¥ç¼–å†™ä½ æƒ³è¦çš„ç¨‹åºã€‚â€œç®€æ´â€ä»£ç ç¼–è¾‘å™¨åªæä¾›å¿…è¦çš„ç»„ä»¶ï¼Œæ¯”å¦‚æ–‡ä»¶åˆ—è¡¨ã€ç»ˆç«¯ã€æœç´¢æ›¿æ¢ã€é«˜äº®ç­‰ã€‚å¦‚æœéœ€è¦æ›´å¤šçš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡å®‰è£…æ’ä»¶çš„æ–¹å¼æ¥æ‰©å±•æ”¯æŒã€‚å½“ç„¶ï¼Œâ€œç®€æ´â€ä»£ç ç¼–è¾‘å™¨ä¼šè¦æ±‚ä½ å¯¹â€œä¸€åˆ‡çš†æ–‡ä»¶â€çš„ Unix/Linux å“²å­¦æœ‰æ¯”è¾ƒå¥½çš„è®¤è¯†ï¼Œå› ä¸ºä½ éœ€è¦é€šè¿‡æ‰‹åŠ¨ä¿®æ”¹æ–‡ä»¶é…ç½®å†…å®¹çš„æ–¹å¼æ¥è®¾ç½®å„ç§å„æ ·çš„ä¸œè¥¿ï¼Œè€Œæå°‘æœ‰äº¤äº’ç•Œé¢æä¾›ã€‚</p>



 </div> </div>
<p>â€ƒâ€ƒå½“æˆ‘ä»¬æŠŠåŸç”Ÿåº”ç”¨å’Œ Web åº”ç”¨æ”¾åœ¨ä¸€èµ·æ¥è€ƒè™‘æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šæƒ³æ˜¯å¦èƒ½æœ‰ä¸€ç§æ–¹å¼å¯ä»¥ç»“åˆä¸¤è€…çš„ä¼˜ç‚¹æ¥ä¸ºç”¨æˆ·æä¾›æ›´å¥½çš„æœåŠ¡å‘¢ï¼Ÿ<strong>PWA äºæ˜¯åº”è¿è€Œç”Ÿ</strong>ã€‚</p>

<div class="premonition info"> <div class="header"> <svg class="icon info" aria-hidden="true"> <use xlink:href="#icon-info"></use> </svg> <div class="title"> å…¶ä»–æ–¹æ¡ˆ </div> </div> <div class="content"> <p>â€ƒâ€ƒé™¤äº† PWA ä¹‹å¤–ï¼Œå…¶å®è¿˜æ˜¯å…¶ä»–çš„æ–¹æ¡ˆå‡ºç°ã€‚æ¯”å¦‚åƒ Hybrid åº”ç”¨ã€React Nativeã€Flutter ç­‰ï¼Œå…·ä½“å¯ä»¥é˜…è¯»å‚è€ƒèµ„æ–™äº†è§£æ›´å¤šã€‚</p>



 </div> </div>
<h3 id="ä»€ä¹ˆæ˜¯æ¸è¿›å¼">ä»€ä¹ˆæ˜¯æ¸è¿›å¼</h3>

<p>â€ƒâ€ƒæ‰€è°“çš„â€œ<strong>æ¸è¿›å¼</strong>â€æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š</p>

<ul>
  <li>ä¸€æ˜¯ <strong>Web åº”ç”¨æ¸è¿›å¼æ¥è¿‘åŸç”Ÿåº”ç”¨</strong>ï¼šé€šè¿‡å„ç§ Web æŠ€æœ¯å®ç°ä¸åŸç”Ÿåº”ç”¨ç›¸è¿‘çš„ç”¨æˆ·ä½“éªŒã€‚</li>
  <li>äºŒæ˜¯<strong>ç»™æ”¯æŒ PWA çš„æµè§ˆå™¨ç”¨æˆ·å¸¦æ¥æ›´å¥½çš„ä½“éªŒ</strong>ï¼šç”±äºä¸åŒæµè§ˆå™¨æ”¯æŒçš„ HTML/CSS çš„æƒ…å†µæœ‰æ‰€å·®åˆ«ï¼Œå¯ä»¥åˆ©ç”¨ PWA æ¥åˆ†æ­¥éª¤ã€åˆ†é˜¶æ®µåœ¨ä¸åŒæµè§ˆå™¨ä¸Šæ–°å¢ç‰¹æ€§ã€‚</li>
</ul>

<div class="premonition note"> <div class="header"> <svg class="icon note" aria-hidden="true"> <use xlink:href="#icon-note"></use> </svg> <div class="title"> æ¸è¿›å¼åº”ç”¨ </div> </div> <div class="content"> <p>â€ƒâ€ƒä¸€ä¸ªæ¸è¿›å¼åº”ç”¨é¦–å…ˆæ˜¯ä¸€ä¸ªç½‘é¡µï¼Œé€šè¿‡å„ç§ Web æŠ€æœ¯ç¼–å†™å‡ºçš„ä¸€ä¸ªç½‘é¡µåº”ç”¨ã€‚ä¹‹åé€šè¿‡æ·»åŠ åº”ç”¨ Manifest å®ç°æ·»åŠ åˆ°ä¸»å±å¹•ï¼Œé€šè¿‡ Service Worker æ¥å®ç°ç¦»çº¿ç¼“å­˜å’Œæ¶ˆæ¯æ¨é€ç­‰åŠŸèƒ½ã€‚</p>



 </div> </div>
<p>â€ƒâ€ƒæ­£æ˜¯ç”±äºè¿™äº›å› ç´ ï¼ŒPWA è‡³å°‘å¯ä»¥ç»™ä½ çš„ç«™ç‚¹å¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š</p>

<ul>
  <li>æ›´å¿«ã€æ›´å®‰å…¨çš„ç”¨æˆ·ä½“éªŒ</li>
  <li>æ›´å¥½çš„æœç´¢æ’åï¼ˆå°¤å…¶å¯¹äº Googleï¼‰</li>
  <li>æ›´å¥½çš„å¯ç”¨æ€§</li>
  <li>æ›´å¥½çš„æ€§èƒ½</li>
  <li>ç¦»çº¿è®¿é—®</li>
  <li>æ‰‹æœºå±å¹•ä¸Šçš„å¿«æ·æ–¹å¼åƒæ˜¯åŸç”Ÿåº”ç”¨</li>
</ul>

<h2 id="ä¸º-jekyll-é…ç½®-pwa">ä¸º Jekyll é…ç½® PWA</h2>

<p>â€ƒâ€ƒä»ä¸Šé¢åˆ—ä¸¾çš„ PWA çš„å¥½å¤„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜¾ç„¶çŸ¥é“ï¼šPWA çš„ç¦»çº¿ç¼“å­˜ã€åŸç”Ÿå¼ä½“éªŒã€æœç´¢å¼•æ“å‹å¥½è¿™äº›ä¼˜ç‚¹éƒ½èƒ½ç”¨äºå®ç°ç«™ç‚¹åŠ é€Ÿã€‚é€šå¸¸çš„é™æ€ç«™ç‚¹åŠ é€Ÿæ–¹æ³•å¯èƒ½æ˜¯ï¼šå‡å°‘è¯·æ±‚ã€ç¼©å‡è¯·æ±‚çš„å¤§å°ã€CDN åŠ é€Ÿç­‰ç­‰ï¼Œä½†æ˜¯ PWA æœ¬èº«çš„ç‰¹æ€§å¯¹äºç”¨æˆ·ä½“éªŒæ¥è¯´ä¹Ÿæ˜¯æœ‰ä¸€äº›åŠ é€Ÿæ•ˆæœçš„ï¼Œæ¯•ç«Ÿè¢«è®¿é—®è¿‡ä¸€æ¬¡å°±ä¼šç¼“å­˜ä¸‹æ¥ã€‚è¿™ä¸ CDN çš„ç¼“å­˜æœ‰äº›ç±»ä¼¼ï¼Œåªä¸è¿‡ CDN æœ‰å¾ˆå¤šç¼“å­˜èŠ‚ç‚¹ï¼Œè€Œ PWA æ˜¯æŠŠæœ¬æœºä½œä¸ºå”¯ä¸€çš„ç¼“å­˜èŠ‚ç‚¹ã€‚</p>

<p>â€ƒâ€ƒç»è¿‡ä¸€ç•ªå¯¹äº Jekyll ä¸Š PWA æ”¯æŒçš„è°ƒæŸ¥åï¼Œå‘ç°çš„ç¡®ä¹Ÿå­˜åœ¨ä¸€äº›å·ç§°å¯ä»¥å¾ˆæ–¹ä¾¿ã€ç®€å•åœ°ä½¿ç”¨çš„ PWA æ’ä»¶ã€‚ä½†æ˜¯å°è¯•äº†ä¸€ä¸‹è§‰å¾—æœ‰ç‚¹å¤æ‚ä¸”æ’ä»¶çœ‹èµ·æ¥æ¯«æ— ç”¨å¤„ã€‚æ ¹æ®ä¸Šé¢æåˆ°çš„ PWA å®ç°æ–¹å¼æ¥çœ‹ï¼Œåªè¦æˆ‘ä»¬é…ç½®å¥½ Manifest å’Œ Service Workerï¼Œå°±å¯ä»¥æŠŠä¸€ä¸ªç«™ç‚¹å…¨éƒ¨å˜æˆ PWA åº”ç”¨ã€‚æ ¹æœ¬ä¸Šä¸æ˜¯å¦ Jekyll æˆ–å…¶ä»–åº”ç”¨æ— å…³ï¼Œå› æ­¤ä½¿ç”¨ PWA æ’ä»¶çš„å¿…è¦æ€§ä¸å¤§ã€‚</p>

<p>â€ƒâ€ƒæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹å¾’æ‰‹é…ç½® PWAã€‚</p>

<h3 id="é…ç½®-manifest">é…ç½® Manifest</h3>

<h4 id="å…ƒä¿¡æ¯">å…ƒä¿¡æ¯</h4>

<p>â€ƒâ€ƒManifest å®é™…ä¸Šæ˜¯ä¸€ä¸ªå£°æ˜äº† PWA åº”ç”¨çš„æ‰€æœ‰å…ƒä¿¡æ¯çš„ JSON é…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æˆ‘ä»¬éœ€è¦å®šä¹‰ PWA åº”ç”¨çš„åç§°ã€è¯­è¨€ã€ç¼©å†™ã€å›¾æ ‡ã€ä¸»é¢˜é¢œè‰²ã€èƒŒæ™¯é¢œè‰²ã€èµ·å§‹è·¯å¾„ã€‚</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"lang"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ site.language }}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dir"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ site.baseurl }}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="err">site.title</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">smartify</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">jsonify</span><span class="w"> </span><span class="p">}},</span><span class="w">
    </span><span class="nl">"short_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{{</span><span class="w"> </span><span class="err">site.pwa.short_name</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">smartify</span><span class="w"> </span><span class="err">|</span><span class="w"> </span><span class="err">jsonify</span><span class="w"> </span><span class="p">}},</span><span class="w">
    </span><span class="nl">"icons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="nl">"src"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ "</span><span class="err">/assets/img/touch/android-chrome</span><span class="mi">-192</span><span class="err">x</span><span class="mi">192</span><span class="err">.png</span><span class="s2">" | prepend: site.baseurl }}"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192x192"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="nl">"src"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ "</span><span class="err">/assets/img/touch/android-chrome</span><span class="mi">-512</span><span class="err">x</span><span class="mi">512</span><span class="err">.png</span><span class="s2">" | prepend: site.baseurl }}"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"512x512"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"src"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ "</span><span class="err">/assets/img/touch/android-chrome-maskable</span><span class="mi">-192</span><span class="err">x</span><span class="mi">192</span><span class="err">.png</span><span class="s2">" | prepend: site.baseurl }}"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192x192"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"purpose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"maskable"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"src"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ "</span><span class="err">/assets/img/touch/android-chrome-maskable</span><span class="mi">-512</span><span class="err">x</span><span class="mi">512</span><span class="err">.png</span><span class="s2">" | prepend: site.baseurl }}"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"sizes"</span><span class="p">:</span><span class="w"> </span><span class="s2">"512x512"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"purpose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"maskable"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w"> 
    </span><span class="nl">"theme_color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ site.pwa.color }}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"background_color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ site.pwa.color }}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"start_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{{ "</span><span class="err">/</span><span class="s2">" | prepend: site.baseurl }}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"display"</span><span class="p">:</span><span class="w"> </span><span class="s2">"standalone"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"orientation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"natural"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>â€ƒâ€ƒè¿™é‡Œå¤§éƒ¨åˆ†çš„å…ƒä¿¡æ¯éƒ½å¯ä»¥é€šè¿‡ Jekyll çš„ _config.yml å…¨å±€é…ç½®æ–‡ä»¶æ¥åŠ¨æ€é…ç½®ã€‚å…¶ä¸­ï¼Œç”±äºå›¾æ ‡éœ€è¦é€‚ç”¨äºä¸åŒçš„è®¾å¤‡ã€å±å¹•åˆ†è¾¨ç‡ï¼Œæ‰€ä»¥éœ€è¦å‡†å¤‡ä¸åŒå°ºå¯¸ã€åˆ†è¾¨ç‡çš„ç«™ç‚¹å›¾æ ‡ã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨ <a href="https://cthedot.de">cthedot</a> å¼€å‘çš„ <a href="https://github.com/cthedot/icongen">cthedot/icongen</a> å·¥å…·æ¥ä¸€é”®ç”Ÿæˆï¼Œéå¸¸ç®€å•æ–¹ä¾¿ã€‚ç”Ÿæˆåå°†å›¾æ ‡æ–‡ä»¶æ”¾ç½®åœ¨ä¸Šé¢è®¾ç½®å¥½çš„ä½ç½®ï¼ˆå¯è‡ªè¡Œå¯¹åº”ä¿®æ”¹ï¼‰ã€‚</p>

<div class="premonition info"> <div class="header"> <svg class="icon info" aria-hidden="true"> <use xlink:href="#icon-info"></use> </svg> <div class="title"> icongen é•œåƒç«™ </div> </div> <div class="content"> <p>â€ƒâ€ƒç”±äº icongen æºç«™åœ¨å¾·å›½ï¼Œäºšæ´²è®¿é—®é€Ÿåº¦æœ‰æ—¶å¯èƒ½ä¸å¤§å¥½ï¼Œæ‰€ä»¥ç¬”è€…ä½¿ç”¨ icongen å¼€æºä»£ç åœ¨ Cloudflare ä¸Šéƒ¨ç½²äº†ä¸€ä¸ªé•œåƒç«™ç‚¹ <a href="https://icongen.pages.dev/">icongen</a>ï¼Œæ¬¢è¿ä½¿ç”¨ã€‚å½“ç„¶ï¼Œç”±äº icongen æ˜¯ä¸€ä¸ªé™æ€é¡µé¢ï¼Œæ— é¡»ä»»ä½•æœåŠ¡å™¨æ‰˜ç®¡ä¹Ÿå¯ä½¿ç”¨ï¼Œå¤§å®¶ä¹Ÿå¯ä¸‹è½½é¡¹ç›®æºä»£ç ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€æºä»£ç ç›®å½•ä¸‹çš„ app/index.html æ–‡ä»¶ä¹Ÿå¯æ­£å¸¸ä½¿ç”¨ã€‚</p>



 </div> </div>
<h4 id="æ¨¡æ¿åŒ–">æ¨¡æ¿åŒ–</h4>

<p>â€ƒâ€ƒç”±äº manifest.json æ–‡ä»¶æˆ‘ä»¬ä¸æƒ³è¦æ¯ä¸ªç”¨æˆ·éƒ½æ¥å¤åˆ¶ä¸€éï¼Œæ‰€ä»¥å¯ä»¥å°†è¿™ä¸ªæ–‡ä»¶å†…å®¹æ¨¡æ¿åŒ–ï¼Œå³æŠŠ manifest.json æ–‡ä»¶æ”¾ç½®åœ¨ _layouts æ–‡ä»¶å¤¹ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œç”¨æˆ·å¯ä»¥éå¸¸ç®€å•åœ°åœ¨æºç çš„ä¸»ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªæ–°çš„ manifest.json æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="nx">layout</span><span class="p">:</span> <span class="nx">manifest</span>
<span class="o">---</span>
</code></pre></div></div>

<p>â€ƒâ€ƒå¦å¤–ï¼Œåœ¨å…¨å±€é…ç½®æ–‡ä»¶ _config.yml ä¸­éœ€ç¡®ä¿æœ‰å¦‚ä¸‹é…ç½®ï¼š</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">language</span><span class="pi">:</span> <span class="s1">'</span><span class="s">zh'</span>
<span class="na">baseurl</span><span class="pi">:</span> <span class="s1">'</span><span class="s">'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Blog'</span>

<span class="c1"># PWA</span>
<span class="na">pwa</span><span class="pi">:</span>
  <span class="na">color</span><span class="pi">:</span> <span class="s1">'</span><span class="s">#81BBFF'</span>
  <span class="na">short_name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">lisz'</span>
</code></pre></div></div>

<h4 id="é“¾æ¥åˆ°é¡µé¢">é“¾æ¥åˆ°é¡µé¢</h4>

<p>â€ƒâ€ƒå½“ä¸Šé¢çš„å†…å®¹éƒ½è®¾ç½®å¥½åï¼Œæˆ‘ä»¬è¿˜éœ€å°† manifest.json çš„å£°æ˜é…ç½®åŠ å…¥åˆ°ç½‘ç«™çš„æ‰€æœ‰é¡µé¢ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒJekyll ä¸»é¢˜åªéœ€è¦åœ¨ head.html å’Œ post-head.html ä¸¤ä¸ªå¤´æ–‡ä»¶æ¨¡å—ä¸­åŠ å…¥ä¸‹é¢å†…å®¹å³å¯ï¼ˆä¸€ä¸ªæ˜¯æ™®é€šé¡µé¢ï¼Œä¸€ä¸ªæ˜¯æ–‡ç« é¡µé¢ï¼‰ã€‚</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"manifest"</span> <span class="na">href=</span><span class="s">"manifest.json"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<h3 id="é…ç½®-service-worker">é…ç½® Service Worker</h3>

<h4 id="æ³¨å†Œ-service-worker">æ³¨å†Œ Service Worker</h4>

<p>â€ƒâ€ƒé…ç½®å®Œ  Manifest ä¹‹åï¼Œåªæ˜¯èƒ½å‘Šè¯‰æµè§ˆå™¨ä½ çš„åº”ç”¨æ˜¯ä¸€ä¸ª PWA åº”ç”¨ï¼Œè€Œå®é™…çš„ PWA çš„ç¦»çº¿ç¼“å­˜ç­‰ç‰¹æ€§éƒ½è¿˜æ²¡æœ‰å®ç°ï¼Œè¿™äº›éƒ½æ˜¯åœ¨ Service Worker ä¸­å®ç°çš„ã€‚é¦–å…ˆåœ¨ _includes ç›®å½•ä¸­åˆ›å»º pwa.html æ–‡ä»¶ï¼Œç”¨äºæ³¨å†Œ PWA åº”ç”¨ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;!-- pwa.html --&gt;
&lt;script&gt;
    if ("serviceWorker" in navigator) {
        if (navigator.serviceWorker.controller) {
            console.log("An active service worker found, no need to register");
        } else {
            // Register the service worker
            navigator.serviceWorker
            .register("<span class="p">{{</span><span class="w"> </span><span class="s2">"/sw.js"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nf">prepend</span><span class="p">:</span><span class="w"> </span><span class="nv">site</span><span class="p">.</span><span class="nv">baseurl</span><span class="w"> </span><span class="p">}}</span>", {
                scope: "<span class="p">{{</span><span class="w"> </span><span class="s2">"/"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nf">prepend</span><span class="p">:</span><span class="w"> </span><span class="nv">site</span><span class="p">.</span><span class="nv">baseurl</span><span class="w"> </span><span class="p">}}</span>"
            })
            .then(function (reg) {
                console.log("Service worker has been registered for scope: " + reg.scope);
            });
        }
    }
&lt;/script&gt;
</code></pre></div></div>

<p>â€ƒâ€ƒå¹¶ä¸”ä¸ºäº†å¯ç”¨ pwa.html å°æ’ä»¶ï¼Œåº”è¯¥åœ¨ page.html å’Œ post.html æ¨¡æ¿çš„ body æœ«å°¾æ·»åŠ ä¸Šå¯¹å°æ’ä»¶çš„å¼•ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

<div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
&lt;body&gt;
...
  <span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="w"> </span>pwa.html<span class="w"> </span><span class="p">%}</span>
...
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div></div>

<h4 id="ç¦»çº¿ç¼“å­˜">ç¦»çº¿ç¼“å­˜</h4>

<p>â€ƒâ€ƒService Worker åŠŸèƒ½å®šä¹‰æ–‡ä»¶å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ª JS æ–‡ä»¶ï¼ˆè¿™é‡Œå‘½åä¸º sw.jsï¼‰ï¼Œå‚è€ƒå†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// sw.js</span>
<span class="kd">const</span> <span class="nx">CACHE</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">pwabuilder-offline</span><span class="dl">"</span><span class="p">;</span>
  
<span class="kd">const</span> <span class="nx">offlineFallbackPage</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">index.html</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Install stage sets up the index page (home page) in the cache and opens a new cache</span>
<span class="nb">self</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">install</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Install Event processing</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">event</span><span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span>
    <span class="nx">caches</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">CACHE</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">cache</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Cached offline page during install</span><span class="dl">"</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">offlineFallbackPage</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">ToDo-replace-this-name.html</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="dl">"</span><span class="s2">Update the value of the offlineFallbackPage constant in the serviceworker.</span><span class="dl">"</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">offlineFallbackPage</span><span class="p">);</span>
    <span class="p">})</span>
<span class="p">);</span>
<span class="p">});</span>

<span class="c1">// If any fetch fails, it will look for the request in the cache and serve it from there first</span>
<span class="nb">self</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">"</span><span class="s2">fetch</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">method</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

<span class="nx">event</span><span class="p">.</span><span class="nx">respondWith</span><span class="p">(</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">request</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Add page to offline cache: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>

        <span class="c1">// If request was success, add or update it in the cache</span>
        <span class="nx">event</span><span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span><span class="nx">updateCache</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">clone</span><span class="p">()));</span>

        <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>        
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Network request Failed. Serving content from cache: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">error</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">fromCache</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">request</span><span class="p">);</span>
    <span class="p">})</span>
<span class="p">);</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">fromCache</span><span class="p">(</span><span class="nx">request</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">// Check to see if you have it in the cache</span>
<span class="c1">// Return response</span>
<span class="c1">// If not in the cache, then return error page</span>
<span class="k">return</span> <span class="nx">caches</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">CACHE</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">cache</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">request</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">matching</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">matching</span> <span class="o">||</span> <span class="nx">matching</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">404</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="dl">"</span><span class="s2">no-match</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">matching</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">});</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">updateCache</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">caches</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">CACHE</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">cache</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">cache</span><span class="p">.</span><span class="nx">put</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<p>â€ƒâ€ƒsw.js æ–‡ä»¶çš„å†…å®¹ä¸»è¦å®šä¹‰äº†ç¬¬ä¸€æ¬¡è®¿é—®æ—¶å°†æ–‡ä»¶ç¦»çº¿ç¼“å­˜ä¸‹æ¥ï¼Œå†æ¬¡è¯·æ±‚æ˜¯ä»ç¼“å­˜ä¸­åŠ è½½ã€‚å¦‚æœé¦–æ¬¡ä»ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°æƒ³è¦çš„æ–‡ä»¶ï¼Œåˆ™ä¼šè¯·æ±‚æ›´æ–°ç¼“å­˜è·å–è¯¥æ–‡ä»¶ã€‚</p>

<h4 id="æ¨¡æ¿åŒ–-1">æ¨¡æ¿åŒ–</h4>

<p>â€ƒâ€ƒä¸ºäº†åœ¨ Jekyll ä¸»é¢˜ä¸­èƒ½æ›´æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œè¿™é‡Œä¹Ÿåº”è¯¥åƒ Manifest é‚£æ ·æ¨¡æ¿åŒ–ï¼Œå³åœ¨ _layouts ç›®å½•ä¸‹åˆ›å»ºä»¥ä¸Šå†…å®¹çš„ sw.js æ–‡ä»¶ã€‚è€Œç”¨æˆ·åªéœ€è¦åœ¨æºä»£ç ä¸»ç›®å½•ä¸‹åˆ›å»ºå¦‚ä¸‹å†…å®¹çš„ sw.js æ–‡ä»¶å³å¯ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="nx">layout</span><span class="p">:</span> <span class="nx">sw</span>
<span class="o">---</span>
</code></pre></div></div>

<h2 id="éªŒè¯-pwa">éªŒè¯ PWA</h2>

<p>â€ƒâ€ƒå½“æˆ‘ä»¬è®¾ç½®å¥½ Manifest å’Œ Service Workerï¼Œå¹¶ä¸”å†æ¬¡ç”Ÿæˆ Jekyll é™æ€é¡µé¢å¹¶æ‰˜ç®¡åˆ°æœåŠ¡å™¨ä¹‹åï¼Œç”¨ Chrome æµè§ˆå™¨è®¿é—®ä¸»é¡µå°±ä¼šå‘ç°åœ°å€æ çš„å³è¾¹ä¼šå‡ºç°ä¸€ä¸ªæ–°çš„å›¾æ ‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™ä¸ªå›¾æ ‡å°±æ˜¯åœ¨æç¤ºä½ æ‰€è®¿é—®çš„é¡µé¢æ˜¯ PWA åº”ç”¨ï¼Œæ”¯æŒå®‰è£…å¿«æ·æ–¹å¼ã€‚ç‚¹å‡»è¯¥å›¾æ ‡ï¼Œä¼šæœ‰ä¸€ä¸ªåƒä¸‹é¢è¿™æ ·çš„å°å¼¹çª—æç¤ºï¼Œç‚¹å‡»å®‰è£…å³å¯å®‰è£…åˆ°ä¸»å±å¹•ï¼ŒPC ç«¯ã€ç§»åŠ¨ç«¯å‡å¯ã€‚</p>

<p><img src="https://i.luish.cc/blog/8nPgKk.webp" alt="å®‰è£…æç¤º Install tips" /></p>

<p>â€ƒâ€ƒé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ PC ç«¯æ‰“å¼€æµè§ˆå™¨çš„æ§åˆ¶å°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸€äº›æ¥è‡ª sw.js çš„æ‰“å°ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å‘Šè¯‰æˆ‘ä»¬ Service Worker å·²ç»æ³¨å†ŒæˆåŠŸäº†ï¼Œå¹¶ä¸”æœ‰å“ªäº›æ–‡ä»¶å·²ç»ç¦»çº¿ç¼“å­˜äº†ã€‚</p>

<p><img src="https://i.luish.cc/blog/OnrGr1.webp" alt="æ§åˆ¶å°æç¤º Command line tips" /></p>

<p>â€ƒâ€ƒåœ¨æµè§ˆå™¨å¼€å‘å·¥å…·ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æŸ¥çœ‹<strong>åº”ç”¨</strong>çš„ <strong>Service Workers</strong> æ¥å†æ¬¡ç¡®è®¤ PWA çš„æƒ…å†µã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° sw.js ä» Initial åˆ° Wait åˆ° Activate çš„è¿‡ç¨‹ï¼Œ</p>

<p><img src="https://i.luish.cc/blog/mXdqdH.webp" alt="åº”ç”¨æç¤º App tips" /></p>

<h2 id="åè®°">åè®°</h2>

<p>â€ƒâ€ƒä»ä¸Šé¢çš„æ­¥éª¤æ¥çœ‹ï¼ŒWeb åº”ç”¨ PWA åŒ–ä¼¼ä¹ä¹Ÿä¸æ˜¯é‚£ä¹ˆéš¾ã€‚åªè¦æœ‰ Manifest å’Œ Service Worker å°±èƒ½æˆåŠŸæŠŠ Web åº”ç”¨ PWA åŒ–ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›æ›´åŠ ç®€å• PWA åŒ–çš„æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ <a href="https://www.pwabuilder.com/">pwabuilder</a>ã€‚ä¸è¿‡ï¼Œpwabuilder æ›´æ“…é•¿å¸®ä½ ä¼˜åŒ– PWA åº”ç”¨å¹¶ä¸”è½¬æˆ Windodwsã€Apple å’Œ Android ä¸‰ä¸ªå¹³å°çš„åº”ç”¨ã€‚å¦‚æœä½ æƒ³è¦æŠŠä½ çš„ PWA åº”ç”¨ä¸Šä¼ åˆ°åº”ç”¨å•†åº—ï¼Œé‚£ä¹ˆä¸å¦¨è¯•è¯•ã€‚</p>

<p>â€ƒâ€ƒé™¤äº† Jekyll ä¹‹å¤–ï¼Œå…¶ä»–çš„é™æ€ç”Ÿæˆå™¨æ¯”å¦‚ Hexoã€Next.js ç­‰ç­‰æˆ–è€…åŠ¨æ€ç½‘ç«™éƒ½å¯ä»¥ PWA åŒ–ï¼Œè€Œä¸”å’Œ CDN åŠ é€Ÿä¸€èµ·ä½¿ç”¨ä¹Ÿéå¸¸åˆé€‚ã€‚</p>

<div class="premonition info"> <div class="header"> <svg class="icon info" aria-hidden="true"> <use xlink:href="#icon-info"></use> </svg> <div class="title"> æ¨èä¸€æ¬¾ PWA åº”ç”¨ </div> </div> <div class="content"> <p>â€ƒâ€ƒå½“å¹´ Google ä¸ºäº†æ¨å¹¿ PWA æ›¾å¼€å‘äº†ä¸€æ¬¾éå¸¸å¥½ç”¨çš„ PWA åº”ç”¨ â€“ <a href="https://squoosh.app/">Squoosh</a>ã€‚è¿™å°±æ˜¯æœ¬åœ°ç‰ˆçš„å›¾ç‰‡æ ¼å¼è½¬æ¢ã€å›¾ç‰‡å‹ç¼©çš„å…è´¹å·¥å…·ï¼Œå®Œå…¨å¯ä»¥æ›¿ä»£å¤§éƒ¨åˆ†å…¶ä»–å·¥å…·ã€‚å¦‚æœä½ å–œæ¬¢ç»ˆç«¯çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="https://github.com/GoogleChromeLabs/squoosh/tree/dev/cli">squoosh cli</a>ã€‚</p>



 </div> </div>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>

<ul>
  <li><a href="https://dev.to/thewhitewulfy/make-any-jekyll-site-into-a-pwa-1de2">Make any Jekyll site into a PWA</a></li>
  <li><a href="https://sunbufu.vercel.app/posts/2019/2019-01-23-pwa/">jekyll åšå®¢çš„ PWA é…ç½®</a></li>
  <li><a href="https://segmentfault.com/a/1190000041729491">å°ç¨‹åºé¼»ç¥– â€”â€” åœ¨å›½å†…é€æ¸æ¶ˆäº¡çš„ PWA å¯ä»¥å¸¦ç»™æˆ‘ä»¬å“ªäº›å¯ç¤ºï¼Ÿ</a></li>
  <li><a href="https://segmentfault.com/a/1190000018590996">Flutter ã€React Native ã€ Ionicã€ NativeScript ã€å°ç¨‹åºå’Œ PWA å“ªä¸ªå€¼å¾—å­¦ï¼Ÿ</a></li>
</ul>

            <div class="post-copyright">
              <p><span>ç‰ˆæƒå£°æ˜ï¼š</span>å¦‚æ— ç‰¹åˆ«å£°æ˜ï¼Œæœ¬æ–‡ç‰ˆæƒå½’&nbsp;<a href="https://lisz.me">Mr Li</a>&nbsp;æ‰€æœ‰ï¼Œè½¬è½½è¯·æ³¨æ˜æœ¬æ–‡é“¾æ¥ã€‚</p>
              <p>ï¼ˆé‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®è¿›è¡Œæˆæƒï¼‰</p>
              <p><span>æœ¬æ–‡æ ‡é¢˜ï¼š</span>ã€Š PWAï¼šå¯èƒ½æ˜¯æˆæœ¬æœ€ä½çš„ç«™ç‚¹åŠ é€Ÿæ–¹å¼ ã€‹</p>
              <p><span>æœ¬æ–‡é“¾æ¥ï¼š</span><a href="https://lisz.me/tech/webmaster/pwa.html">https://lisz.me/tech/webmaster/pwa.html</a></p>
            </div>
          </article>
        </div>   
        <div class="table-of-contents">
          <h2>Contents</h2>
          <ul><li><a href="#å‰è¨€">å‰è¨€</a><ul><li><a href="#ä¸ºä½•æœ‰-pwa">ä¸ºä½•æœ‰ PWA</a></li><li><a href="#ä»€ä¹ˆæ˜¯æ¸è¿›å¼">ä»€ä¹ˆæ˜¯æ¸è¿›å¼</a></li></ul></li><li><a href="#ä¸º-jekyll-é…ç½®-pwa">ä¸º Jekyll é…ç½® PWA</a><ul><li><a href="#é…ç½®-manifest">é…ç½® Manifest</a><ul><li><a href="#å…ƒä¿¡æ¯">å…ƒä¿¡æ¯</a></li><li><a href="#æ¨¡æ¿åŒ–">æ¨¡æ¿åŒ–</a></li><li><a href="#é“¾æ¥åˆ°é¡µé¢">é“¾æ¥åˆ°é¡µé¢</a></li></ul></li><li><a href="#é…ç½®-service-worker">é…ç½® Service Worker</a><ul><li><a href="#æ³¨å†Œ-service-worker">æ³¨å†Œ Service Worker</a></li><li><a href="#ç¦»çº¿ç¼“å­˜">ç¦»çº¿ç¼“å­˜</a></li><li><a href="#æ¨¡æ¿åŒ–-1">æ¨¡æ¿åŒ–</a></li></ul></li></ul></li><li><a href="#éªŒè¯-pwa">éªŒè¯ PWA</a></li><li><a href="#åè®°">åè®°</a></li><li><a href="#å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</a></li></ul>
        </div>
      </div>
      

      
      <div class="social-share-wrapper">
        <div class="social-share"></div>
      </div>
      
    </div>

    <section class="author-detail">
      <section class="post-footer-item author-card">
        <div class="avatar">
          <img src="/assets/img/profile.webp" alt="">
        </div>
        <div class="author-name" rel="author">zhonger</div>
        <div class="bio">
          <p>Developer & Maintainer</p>
        </div>
        
        <ul class="sns-links">
          
          <li>
            <a href="https://scholar.google.com/citations?user=AUupIooAAAAJ" target="_blank" aria-label="google-scholar">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-google-scholar"></use>
              </svg>
            </a>
          </li>
          
          <li>
            <a href="https://www.researchgate.net/profile/Shengzhou-Li" target="_blank" aria-label="researchgate">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-researchgate"></use>
              </svg>
            </a>
          </li>
          
          <li>
            <a href="https://orcid.org/0000-0001-6973-3825" target="_blank" aria-label="ORCID">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-ORCID"></use>
              </svg>
            </a>
          </li>
          
          <li>
            <a href="https://github.com/zhonger" target="_blank" aria-label="github">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-github"></use>
              </svg>
            </a>
          </li>
          
          <li>
            <a href="https://www.linkedin.com/in/shengzhouli/" target="_blank" aria-label="linkedin">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-linkedin"></use>
              </svg>
            </a>
          </li>
          
          <li>
            <a href="https://segmentfault.com/u/wuwozhonger" target="_blank" aria-label="segmentfault">
              <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-segmentfault"></use>
              </svg>
            </a>
          </li>
          
        </ul>
        
      </section>
      <section class="post-footer-item read-next">
        

        
        <div class="read-next-item">
          <a href="/tech/webmaster/gpg.html" class="read-next-link" aria-label="GPGï¼šä¸ºä½ çš„ Git æäº¤è®°å½•åŠ ä¸€æŠŠé”"></a>
            <section>
              <span>GPGï¼šä¸ºä½ çš„ Git æäº¤è®°å½•åŠ ä¸€æŠŠé”</span>
              <p>å‰è¨€</p>
            </section>
            
            <div class="filter"></div>
            <img src="https://i.luish.cc/cover/skxyHS.webp" alt="">
            
        </div>
        
      </section>
      
   
      

      
    </section>

    <footer class="g-footer">
  <section>Mr Li Â©
  
  
    2015
    -
  
  2022
  
    <a href="https://beian.miit.gov.cn/" target="_blank">æ²ªICPå¤‡15014851å·</a>
  
  </section>
  <section>Powered by <a href="//jekyllrb.com">Jekyll</a> & <a href="https://github.com/zhonger/jekyll-theme-H2O-ac">H2O-ac</a> v1.1.9  (based on <a href="https://github.com/kaeyleo/jekyll-theme-H2O">H2O</a>) 
  
  </section>
  
  <section>
    <span id="busuanzi_container_site_pv">
      ğŸ‘ï¸ Total Views <span id="busuanzi_value_site_pv"></span> <b>Â·</b>
    </span>
    <span id="busuanzi_container_site_uv">
      ğŸ‘¤ Total Visitors <span id="busuanzi_value_site_uv"></span>
    </span>
  </section>
  
</footer>
<button id="list" aria-label="Scroll back to top" class="mobile-list" type="button">
  <svg class="icon list day" aria-hidden="true">
    <use xlink:href="#icon-list-day"></use>
  </svg>
  <svg class="icon list night" aria-hidden="true">
    <use xlink:href="#icon-list-night"></use>
  </svg>
  <svg class="icon exit day" aria-hidden="true">
    <use xlink:href="#icon-exit-day"></use>
  </svg>
  <svg class="icon exit night" aria-hidden="true">
    <use xlink:href="#icon-exit-night"></use>
  </svg>
</button>
<button id="bttb" aria-label="Scroll back to top" class="bttb" type="button">
  <svg class="icon up day" aria-hidden="true">
    <use xlink:href="#icon-up-day"></use>
  </svg>
  <svg class="icon up night" aria-hidden="true">
    <use xlink:href="#icon-up-night"></use>
  </svg>
</button>


  </div>

  <script src="/assets/js/social-share.min.js"></script>
  <script>
    socialShare('.social-share', {
      sites: [
        
          'wechat'
          ,
          
        
          'weibo'
          ,
          
        
          'douban'
          ,
          
        
          'twitter'
          
        
      ],
      wechatQrcodeTitle: "åˆ†äº«åˆ°å¾®ä¿¡æœ‹å‹åœˆ",
      wechatQrcodeHelper: '<p>æ‰«ç åç‚¹å‡»å³ä¸Šè§’</p><p>å°†æœ¬æ–‡åˆ†äº«è‡³æœ‹å‹åœˆ</p>'
    });
    $("a.social-share-icon").each(function() {
      $(this).attr("aria-label", $(this).attr("class").split(' ')[1])
    });
  </script>

  

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
  <script src="/assets/js/index.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js" async></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.2/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.2/plugin/customParseFormat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.2/plugin/relativeTime.js"></script>
  <script>
      // ç»™å›¾ç‰‡æ·»åŠ é“¾æ¥
      $(document).ready(function() {
          var baseurl = $("meta[property='og:baseurl']").attr('content');
          $("p img").each(function() {
              $(this).attr('data-src', $(this).attr('src')).removeAttr('src').addClass("lazyload").attr('src', baseurl + '/assets/img/loading.gif');
              var strA = "<a data-fancybox='gallery' ref='gallery' href='" + $(this).attr('data-src') + "' data-caption='" + $(this).attr('alt') + "'></a>";
              $(this).wrapAll(strA);
          });

          Fancybox.bind('[data-fancybox]', {
            on: {
              load: (fancybox, slide) => {
                var gray = $("meta[property='og:gray']").attr('content');
                if(gray == "true"){
                    $(".fancybox__content img").addClass("gray");
                    $(".carousel__track .fancybox__thumb").addClass("gray");
                }
              }
            }
          });   
          
          

          if($("#comments-switch").length > 0){
            var comment_status = $("#cmn-toggle-4")[0].checked;
            if(comment_status){
              $("#waline").addClass("active");
            }else {
              $("#disqus_thread").addClass("active");
            }
            $("#cmn-toggle-4").click(function(){
              $("#disqus_thread").toggleClass("active");
              $("#waline").toggleClass("active");
            })
          }else {
            if($("#disqus_thread").length > 0) {
              $("#disqus_thread").addClass("active");
            }else if($("#waline").length > 0) {
              $("#waline").addClass("active");
            }
          }

          var time_formats = ['YYYY-MM-DD HH:mm:ss ZZ', 'YYYY DD MMM HH:mm:ss ZZ', 'YYYYå¹´MMæœˆDDæ—¥ HH:mm:ss ZZ'];
          function dateFormat(date, format){
            var date_org = dayjs(date, time_formats[format]);
            var date     = date_org.format(time_formats[format]);
            return {"date_org": date_org, "date": date}
          }

          dayjs.extend(window.dayjs_plugin_customParseFormat);
          dayjs.extend(window.dayjs_plugin_relativeTime);
          var post_date = $("meta[property='post-date']").attr('content');
          var post_date_format = $("meta[property='post-date-format']").attr('content');
          var local_post_date = dateFormat(post_date, post_date_format);

          $(".post time span.create-at").html(local_post_date["date"]);

          fetch("https://api.github.com/repos/zhonger/zhonger.github.io/commits?path=_posts/2022-06-03-pwa.md")
          .then((response) => {
            return response.json();
          })
          .then((commits) => {
            if(commits.length != 0){
              var update_at = dayjs(commits[0]['commit']['committer']['date']);
            }else {
              var update_at = post_date
            }

            var local_update_at = dateFormat(update_at, post_date_format);
            $('.post time span.update-at').html(local_update_at["date"]);

            var relative_time = dayjs().diff(local_update_at["date_org"], 'day');
            if(relative_time > 365){
              $(".post-copyright").append("<p class='tips'>æœ¬æ–‡æœ€åä¸€æ¬¡æ›´æ–°ä¸º <span>" + relative_time + "</span> å¤©å‰ï¼Œæ–‡ç« ä¸­çš„æŸäº›å†…å®¹å¯èƒ½å·²è¿‡æ—¶ï¼</p>");
            }
          });         
      });
  </script>
  <script src="https://at.alicdn.com/t/font_3046306_skfh9jzzbbf.js"></script>
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9E8SEJ5JNY"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-9E8SEJ5JNY');
</script>

  
  
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  <script>
    if ("serviceWorker" in navigator) {
        if (navigator.serviceWorker.controller) {
            console.log("An active service worker found, no need to register");
        } else {
            // Register the service worker
            navigator.serviceWorker
            .register("/sw.js", {
                scope: "/"
            })
            .then(function (reg) {
                console.log("Service worker has been registered for scope: " + reg.scope);
            });
        }
    }

// æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒSW
// if(navigator.serviceWorker != null){
//     navigator.serviceWorker.register("/sw.js")
//         .then(function(registartion){
//             console.log('æ”¯æŒsw:',registartion.scope)
//         })
// } else {
//     console.log('ä¸æ”¯æŒsw')
// }
</script>
  
	<!--
Author: Ray-Eldath
refer to:
 - http://docs.mathjax.org/en/latest/options/index.html
-->

	<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["$", "$"] ],
			displayMath: [ ["$$", "$$"] ],
			skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
		},
		"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
      });
    </script>

	
</body>

</html>
